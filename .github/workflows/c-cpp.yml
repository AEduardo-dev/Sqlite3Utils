name: C/C++ CI

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]
  schedule:
    - cron: "0 2 * * 1-5"
  workflow_dispatch:

jobs:
  build_ubuntu:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2
    - name: configure
      run: ./configure
    - name: make
      run: make
    - name: make check
      run: make check
    - name: make distcheck
      run: make distcheck
    
  build_windows:

    runs-on: windows-latest

    steps:
    - uses: actions/checkout@v2
    - name: configure
      run: ./configure
    - name: make
      run: make
    - name: make check
      run: make check
    - name: make distcheck
      run: make distcheck
      
  style:
    
    runs-on: ubuntu-latest
    steps:
    - name: C++ Style Check
    # You may pin to the exact commit or the version.
    # uses: coleaeason/actions-uncrustify@70f17f40b57ff933121e3cccafde98ea3eb0dee9
      uses: coleaeason/actions-uncrustify@v1
      
  cppcheck:
    
    runs-on: ubuntu-latest
    
    steps:
    - name: cppcheck-action
      # You may pin to the exact commit or the version.
      # uses: deep5050/cppcheck-action@1c1883644278ced5cc18c37e32eb26337e340a9e
      uses: deep5050/cppcheck-action@v1.2
      
